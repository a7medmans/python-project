# دليل إنشاء ملف التثبيت

## المتطلبات

1. **Python 3.8+** - مثبت بالفعل ✅
2. **PyInstaller** - سيتم تثبيته تلقائياً
3. **Inno Setup** (لإنشاء ملف التثبيت) - [تحميل من هنا](https://jrsoftware.org/isdl.php)

## خطوات البناء

### الطريقة السريعة (موصى بها):

```bash
build_with_installer.bat
```

هذا السكريبت سيقوم بـ:
1. ✅ تثبيت المكتبات المطلوبة
2. ✅ إنشاء الأيقونة (icon.ico)
3. ✅ بناء الملف القابل للتنفيذ (PDFPageRemover.exe)
4. ✅ إنشاء ملف التثبيت (PDFPageRemover_Setup.exe)

### الطريقة اليدوية:

#### 1. إنشاء الأيقونة:
```bash
python create_icon.py
```

#### 2. بناء الملف القابل للتنفيذ:
```bash
python build_installer.py
```

#### 3. إنشاء ملف التثبيت:
```bash
iscc installer.iss
```

## النتيجة

بعد البناء، ستجد:

- **`dist/PDFPageRemover.exe`** - الملف القابل للتنفيذ (يمكن استخدامه مباشرة)
- **`installer_output/PDFPageRemover_Setup.exe`** - ملف التثبيت (موصى به للتوزيع)

## تحسينات الحجم

تم تطبيق التحسينات التالية لتقليل حجم الملف:

1. ✅ **استبعاد المكتبات غير الضرورية** - تم استبعاد matplotlib, numpy, scipy, إلخ
2. ✅ **ضغط UPX** - ضغط الملفات الثنائية
3. ✅ **إزالة رموز التصحيح** - strip=True
4. ✅ **تحسين الكود** - optimize=2

## تثبيت Inno Setup

1. قم بتحميل Inno Setup من: https://jrsoftware.org/isdl.php
2. قم بتثبيته
3. أضف `C:\Program Files (x86)\Inno Setup 6` إلى PATH (أو استخدم المسار الكامل)

## تخصيص ملف التثبيت

يمكنك تعديل ملف `installer.iss` لتخصيص:
- اسم التطبيق والإصدار
- الأيقونة
- مجلد التثبيت الافتراضي
- الاختصارات
- وغيرها...

## استكشاف الأخطاء

### المشكلة: "iscc غير موجود"
**الحل:** تأكد من تثبيت Inno Setup وإضافته إلى PATH

### المشكلة: حجم الملف كبير جداً
**الحل:** 
- تأكد من تفعيل UPX
- تحقق من استبعاد المكتبات غير الضرورية في ملف .spec

### المشكلة: الأيقونة لا تظهر
**الحل:** تأكد من وجود ملف `icon.ico` في المجلد الرئيسي
